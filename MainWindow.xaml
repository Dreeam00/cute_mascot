<Window x:Class="MascotApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="デスクトップマスコット" 
        Height="476" 
        Width="400"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Topmost="True"
        ResizeMode="NoResize"
        ShowInTaskbar="False"
        MouseLeftButtonDown="Window_MouseLeftButtonDown">

    <Window.Resources>
        <!-- マスコット吹き出し -->
        <Style x:Key="MascotBubbleStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="15"/>
            <Setter Property="BorderBrush" Value="#FFE0E0E0"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Margin" Value="10,0,60,0"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="Gray" Direction="270" ShadowDepth="3" BlurRadius="5" Opacity="0.3"/>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- ユーザー吹き出し -->
        <Style x:Key="UserBubbleStyle" TargetType="Border">
            <Setter Property="Background" Value="#FF4A90E2"/>
            <Setter Property="CornerRadius" Value="15"/>
            <Setter Property="BorderBrush" Value="#FF357ABD"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Margin" Value="60,0,10,0"/>
            <Setter Property="HorizontalAlignment" Value="Right"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="Gray" Direction="90" ShadowDepth="3" BlurRadius="5" Opacity="0.3"/>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- ボタンのスタイル -->
        <Style x:Key="ConversationButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#FF4A90E2"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Margin" Value="5,0,0,0"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="MinWidth" Value="80"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="5"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"
                                            Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FF357ABD"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#FF2E6DA4"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <!-- キャラクター画像 -->
        <Image x:Name="CharacterImage" 
               Source="Images/mascot.png" 
               Stretch="Uniform"
               Width="120"
               Height="120"
               HorizontalAlignment="Center"
               VerticalAlignment="Top"
               Margin="0,238,0,0"
               MouseLeftButtonDown="CharacterImage_MouseLeftButtonDown"
               Cursor="Hand">
            <Image.RenderTransform>
                <ScaleTransform x:Name="CharacterScale" ScaleX="1" ScaleY="1"/>
            </Image.RenderTransform>
        </Image>

        <!-- 吹き出し表示エリア -->
        <StackPanel VerticalAlignment="Top" Margin="0,20,0,100" Height="160" HorizontalAlignment="Center">
            <!-- ユーザー吹き出し（右寄せ） -->
            <Border x:Name="UserBubble" Style="{StaticResource UserBubbleStyle}" Visibility="Collapsed" MaxWidth="250">
                <TextBlock x:Name="UserText" Text="" Foreground="White" FontSize="14" TextWrapping="Wrap" TextAlignment="Center"/>
            </Border>
            <!-- マスコット吹き出し（左寄せ） -->
            <Border x:Name="MascotBubble" Style="{StaticResource MascotBubbleStyle}" Visibility="Collapsed" MaxWidth="250">
                <TextBlock x:Name="MascotText" Text="" Foreground="#FF333333" FontSize="14" TextWrapping="Wrap" TextAlignment="Center"/>
            </Border>
        </StackPanel>

        <!-- ボタン群 -->
        <StackPanel VerticalAlignment="Bottom" Margin="0,0,0,20" HorizontalAlignment="Center">
            <!-- 1行目のボタン -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,5">
                <Button x:Name="GreetingButton" Style="{StaticResource ConversationButtonStyle}" Click="GreetingButton_Click" Width="80"/>
                <Button x:Name="WeatherButton" Style="{StaticResource ConversationButtonStyle}" Click="WeatherButton_Click" Width="80"/>
                <Button x:Name="TimeButton" Style="{StaticResource ConversationButtonStyle}" Click="TimeButton_Click" Width="80"/>
                <Button x:Name="JokeButton" Style="{StaticResource ConversationButtonStyle}" Click="JokeButton_Click" Width="80"/>
            </StackPanel>
            <!-- 2行目のボタン -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,5">
                <Button x:Name="GoodbyeButton" Style="{StaticResource ConversationButtonStyle}" Click="GoodbyeButton_Click" Width="80"/>
                <Button x:Name="HowAreYouButton" Style="{StaticResource ConversationButtonStyle}" Click="HowAreYouButton_Click" Width="80"/>
                <Button x:Name="ComplimentButton" Style="{StaticResource ConversationButtonStyle}" Click="ComplimentButton_Click" Width="80"/>
                <Button x:Name="MotivationButton" Style="{StaticResource ConversationButtonStyle}" Click="MotivationButton_Click" Width="80"/>
            </StackPanel>
            <!-- 3行目のボタン -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,5">
                <Button x:Name="AdviceButton" Style="{StaticResource ConversationButtonStyle}" Click="AdviceButton_Click" Width="80"/>
                <Button x:Name="StoryButton" Style="{StaticResource ConversationButtonStyle}" Click="StoryButton_Click" Width="80"/>
                <Button x:Name="FoodButton" Style="{StaticResource ConversationButtonStyle}" Click="FoodButton_Click" Width="80"/>
                <Button x:Name="MusicButton" Style="{StaticResource ConversationButtonStyle}" Click="MusicButton_Click" Width="80"/>
            </StackPanel>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <Button x:Name="StudyButton" Style="{StaticResource ConversationButtonStyle}" Click="StudyButton_Click" Width="80"/>
                <Button x:Name="SleepButton" Style="{StaticResource ConversationButtonStyle}" Click="SleepButton_Click" Width="80"/>
                <Button x:Name="ThanksButton" Style="{StaticResource ConversationButtonStyle}" Click="ThanksButton_Click" Width="80"/>
            </StackPanel>
        </StackPanel>

        <!-- 右クリックメニュー -->
        <Popup x:Name="ContextMenuPopup" Placement="MousePoint" IsOpen="False">
            <Border Background="White" BorderBrush="#FFCCCCCC" BorderThickness="1" CornerRadius="5">
                <StackPanel Margin="5">
                    <Button Content="メニューを開く" Background="Transparent" BorderThickness="0" Padding="10,5" HorizontalAlignment="Stretch" Click="OpenMenuButton_Click" Cursor="Hand"/>
                    <Button Content="終了" Background="Transparent" BorderThickness="0" Padding="10,5" HorizontalAlignment="Stretch" Click="ExitButton_Click" Cursor="Hand"/>
                </StackPanel>
            </Border>
        </Popup>
    </Grid>
</Window> 